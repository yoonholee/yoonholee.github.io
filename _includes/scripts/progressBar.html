{% if site.enable_progressbar %}

<!-- Progress bar that shows reading position while scrolling (vanilla JS - jQuery removed) -->
<script>
  (function () {
    "use strict";

    const progressBar = document.getElementById("progress");
    if (!progressBar) return;

    let ticking = false;

    function updateProgress() {
      const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
      const docHeight = document.documentElement.scrollHeight - window.innerHeight;

      if (docHeight > 0) {
        const scrollPercent = (scrollTop / docHeight) * 100;
        progressBar.value = scrollPercent;
      }

      ticking = false;
    }

    function requestTick() {
      if (!ticking) {
        window.requestAnimationFrame(updateProgress);
        ticking = true;
      }
    }

    // Update on scroll (throttled with RAF)
    window.addEventListener("scroll", requestTick, { passive: true });

    // Update on load and resize
    window.addEventListener("load", updateProgress);
    window.addEventListener("resize", updateProgress);

    // Initial update
    updateProgress();
  })();
</script>

{%- endif %}
