repos:
  # Standard pre-commit hooks
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.6.0
    hooks:
      - id: trailing-whitespace
        exclude: '_bibliography/.*\.bib$|CV/tmp/.*\.(aux|log)$'
      - id: end-of-file-fixer
      - id: check-yaml
        exclude: '_config\.yml' # Jekyll uses non-standard YAML
      - id: check-added-large-files
        args: ["--maxkb=1000"]
      - id: mixed-line-ending
        args: ["--fix=lf"]
      - id: check-merge-conflict
      - id: detect-private-key

  # Prettier for code formatting
  - repo: https://github.com/pre-commit/mirrors-prettier
    rev: v4.0.0-alpha.8
    hooks:
      - id: prettier
        types_or: [javascript, json, markdown, yaml]
        exclude: "^(_site/|vendor/|node_modules/|_bibliography/)"
        args: ["--config", ".prettierrc"]

  # Stylelint for CSS/SCSS
  - repo: https://github.com/thibaudcolas/pre-commit-stylelint
    rev: v16.10.0
    hooks:
      - id: stylelint
        files: \.(css|scss)$
        args: ["--fix"]
        additional_dependencies:
          - "stylelint@^16.10.0"
          - "stylelint-config-standard-scss@^13.1.0"
          - "postcss@^8.4.47"

  # ESLint for JavaScript
  - repo: https://github.com/pre-commit/mirrors-eslint
    rev: v9.14.0
    hooks:
      - id: eslint
        files: \.(js)$
        args: ["--fix"]
        additional_dependencies:
          - "eslint@^9.14.0"
          - "@eslint/js@^9.14.0"
          - "globals@^15.12.0"

  # BibTeX validation (optional but recommended)
  - repo: local
    hooks:
      - id: bibtex-check
        name: Check BibTeX syntax
        entry: bash -c 'bibtex -terse _bibliography/papers.bib || true'
        language: system
        files: '\.bib$'
        pass_filenames: false

      # Build CV when LaTeX files change
      - id: build-cv
        name: Build CV PDF
        entry: bash -c 'cd CV && xelatex -interaction=nonstopmode -output-directory=tmp main.tex > /dev/null 2>&1 && git add tmp/main.pdf'
        language: system
        files: '^CV/.*\.tex$'
        pass_filenames: false
