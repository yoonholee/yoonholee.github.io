document.addEventListener("DOMContentLoaded",()=>{function t(){const t=window.pageYOffset/(document.documentElement.scrollHeight-window.innerHeight),e=document.getElementById("toc"),n=e.scrollHeight,o=Math.min(t*n,n);e.style.setProperty("--progress-height",`${o}px`)}const e=document.getElementById("toc"),n=document.querySelector(".post-content");if(!e||!n)return;const o=n.querySelectorAll("h1");if(0===o.length)return void(e.style.display="none");const c=document.createElement("h4");c.textContent="Contents",e.appendChild(c);const i=document.createElement("ul");o.forEach((t,e)=>{if(!t.id){const n=t.textContent.trim().toLowerCase().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"");t.id=n||`section-${e}`}const n=document.createElement("li"),o=document.createElement("a");o.href=`#${t.id}`,o.textContent=t.textContent,o.setAttribute("data-heading-id",t.id),n.appendChild(o),i.appendChild(n)}),e.appendChild(i);const d=document.querySelectorAll("#toc a");let s=null;const a=new IntersectionObserver(t=>{let e=null,n=1/0;if(t.forEach(t=>{if(t.isIntersecting){const o=t.target.getBoundingClientRect();o.top<n&&(n=o.top,e=t)}}),e){const t=e.target.getAttribute("id"),n=document.querySelector(`#toc a[data-heading-id="${t}"]`);n&&n!==s&&(s&&s.classList.remove("active"),n.classList.add("active"),s=n)}},{rootMargin:"-20% 0% -70% 0%",threshold:0});o.forEach(t=>a.observe(t)),d.forEach(t=>{t.addEventListener("click",e=>{e.preventDefault();const n=t.getAttribute("data-heading-id"),o=document.getElementById(n);if(o){const e=150,n=o.getBoundingClientRect().top+window.pageYOffset-e;o.classList.add("toc-highlight"),setTimeout(()=>{o.classList.remove("toc-highlight")},1e3),window.scrollTo({top:n,behavior:"smooth"}),s&&s.classList.remove("active"),t.classList.add("active"),s=t}})});const l=o[0];if(l){const t=document.querySelector(`#toc a[data-heading-id="${l.id}"]`);t&&(t.classList.add("active"),s=t)}window.addEventListener("scroll",t),t()});